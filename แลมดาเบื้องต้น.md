# λ ใน Java 8
แลมดาใน Java 8 สามารถเขียนได้เช่น 

`() -> "Hello Lambda"`

`x -> Math.sqrt(x)`

`(a , b) -> a+b`

`(a , b) -> {int c = a + b; return c;}`


##  วิธีการใช้งานเบื้องต้น
โค๊ดก่อนที่ยังไม่มีแลมดา เมื่อต้องการเรียงลำดับข้อมูลทีอยู่ในลิส
```java
	List<String> names = Arrays.asList("a","c","b");
	names.sort(new Comparator<String>()
	{
		@Override
		public int compare(String str1, String str2)
		{
			return str1.compareTo(str2);
		}
	});
	for(String name:names)
	{
		System.out.println(name);
	}
	
```

จากข้างบน ถ้าไม่ใช้คลาส anonymous ก็สามารถแยกออกได้เป็น

```java
	Comparator<String> asc = new Comparator<String>()
	{
		@Override
		public int compare(String str1, String str2)
		{
			return str1.compareTo(str2);
		}
	};
	
	List<String> names = Arrays.asList("a","c","b");
	names.sort(asc);
	for(String name:names)
	{
		System.out.println(name);
	}
	
```

ถ้าใช้แลมดาเข้าร่วมด้วย โค๊ดข้างบนก็จะได้

```java
	Comparator<String> asc = (str1,str2) -> str1.compareTo(str2);
			
	List<String> names = Arrays.asList("a","c","b");
	names.sort(asc);
	for(String name:names)
	{
		System.out.println(name);
	}

```

และก็สามารถใช้แบบ anonymous 

```java
	List<String> names = Arrays.asList("a","c","b");
	names.sort((str1,str2) -> str1.compareTo(str2));
	for(String name:names)
	{
		System.out.println(name);
	}
	
```

ใน Java 8 มีเรื่องของ stream เข้ามาเกี่ยวข้องด้วย แต่ก่อนจะเข้าถึงรายละเอียด การเห็นตัวอย่างก่อนสามารถช่วยให้เข้าใจง่ายได้ยิ่งขึ้น จาก `for loop` ข้างบนเราสามารถเขียนใหม่ได้เป็น

```java
	List<String> names = Arrays.asList("a","c","b");
	names.sort((str1,str2) -> str1.compareTo(str2));
	names.stream().forEach(name -> System.out.println(name));
	
```

หรือจะสามารถเอา stream ออกก็ได้ เพราะ Java 8 ได้มีการปรับปรุงหลายๆคลาสเช่น `BufferedReader`, `Random`, และ `BitSet` ให้ซัพพอร์ตกับ stream

```java
	List<String> names = Arrays.asList("a","c","b");
	names.sort((str1,str2) -> str1.compareTo(str2));
	names.forEach(name -> System.out.println(name));
```
หรือถ้าต้องการแสดงผลแบบ sort โดยไม่เปลี่ยน stage ของลิสก็สามารถทำได้เช่น

```java
	List<String> names = Arrays.asList("a","c","b");
	names.stream().sorted().forEach(name->System.out.println(name));	
```

##  ตัวอย่างปัญหา
ในบทถัดไปเราจะมาเริ่มเรียนรู้และเข้าใจแลมดาจากพื้นฐาน แต่ด้วยตัวอย่างข้างบน อาจเห็นภาพไม่ชัดว่าแลมดากับสตรีมในจาวา 8 จะเอาไปใช้งานจริงๆได้อย่างไร

สมมุติว่าเรามีคลาส `Company` ,  `Customer` และ `Product` โดยแต่ละบริษัทสามารถผลิตโปรดักได้เป็นของตัวเอง โดยกำหนดว่าโปรดักอย่างเดียวกันจะมีไอดีเหมือนกัน แต่ราคาต่างกันไปตามแต่ละบริษัท จากนั้นเราก็จะมีลิสของลูกค้า ซึ่งแต่ละรายก็จะมีลิสของไอดีของโปรดักไว้ โค๊ดข้างล่างคือการเซ็ตตัวแปรต่างๆตามโจทย์

```java
	@Before
	public void init()
	{
		companies = new ArrayList<>();
		customers = new ArrayList<>();
		Random rand = new Random();
		for (int companyId = 0; companyId < 10; companyId++)
		{
			Company newCompany = new Company();
			newCompany.setId(companyId);
			List<Product> newProducts = new ArrayList<Product>(100);
			for (int i = 0; i < 100; i++)
			{
				Product p = new Product();
				p.setId(i);
				p.setPrice(Math.random() * 100);
				newProducts.add(p);
			}
			newCompany.setProducts(newProducts);
			companies.add(newCompany);
		}

		for (int customerId = 0; customerId < 5; customerId++)
		{
			Customer newCustomer = new Customer();
			newCustomer.setId(customerId);
			int numberOfItem = rand.nextInt(100) + 1;
			List<Integer> demands = new ArrayList<>(numberOfItem);
			for (int i = 0; i < numberOfItem; i++)
			{
				demands.add(i);
			}
			newCustomer.setDemands(demands);
			customers.add(newCustomer);

		}

	}
	
```

######คำถาม
ให้หาว่าลถ้าูกค้าแต่ละคนต้องการจะซื้อของให้ครบตามที่ต้องการ จะต้องจ่ายเงินน้อยที่สุดเท่าไหร่ โดยทำการเก็บค่าเป็น `Map<Customer, Double>` (โจทย์อาจไม่สมจริงในด้านธุรกิจ แต่เพื่อให้ง่ายต่อการศึกษาเรื่องแลมดา เราจะเอาประมาณนี้)

ถ้ายังเป็นจาวาที่ยังไม่มีแลมดากับสตรีมเข้ามาช่วย วิธีหนึ่งที่สามารถเขียนได้อย่างเช่น

```java
	Map<Customer, Double> leastCost = new HashMap<>();
	for (Customer customer : customers)
	{
		double totalCost = 0;
		for (Integer productId : customer.getDemands())
		{
			double minCost = Double.MAX_VALUE;
			for (Company company : companies)
			{
				for (Product offer : company.getProducts())
				{
					if (offer.getId() == productId)
					{
						if (offer.getPrice() < minCost)
						{
							minCost = offer.getPrice();
						}
					}
				}
			}
			totalCost += minCost;
		}
		leastCost.put(customer, totalCost);
	}
	
```

หากเราแก้ปัญหานี้ด้วยฟีเจอร์ของจาวา 8 หนึ่งในหลายๆวิธีที่สามารถทำได้ก็คือ

```java
	Map<Customer, Double> leastCost =
			customers
			.stream()
			.collect(
					Collectors.toMap(
							Function.identity(), 
							customer -> customer
										.getDemands()
										.stream()
										.mapToDouble(
												productId -> companies
														.stream()
														.flatMap(cmp -> cmp.getProducts().stream())
														.filter(offer -> offer.getId() == productId)
														.min(Comparator.comparing(offer -> offer.getPrice()))
														.get().getPrice())
										.sum()));


```

##  แตกต่างกันแค่ซินแทกเหรอ ?
หกด


